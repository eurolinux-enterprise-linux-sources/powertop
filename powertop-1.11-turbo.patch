From a95837fa27e6295d800cb73f52784271e544b1c3 Mon Sep 17 00:00:00 2001
From: Arjan van der Ven <arjan@linux.intel.com>
Date: Wed, 05 Aug 2009 23:50:26 +0000
Subject: show turbo mode explicitly

git-svn-id: https://powertop.googlecode.com/svn/trunk@328 0bbd23ad-e62f-0410-b3b3-4ddab988b7fa
---
diff --git a/cpufreqstats.c b/cpufreqstats.c
index 4f8a15b..6388c3a 100644
--- a/cpufreqstats.c
+++ b/cpufreqstats.c
@@ -62,6 +62,17 @@ int sort_by_freq (const void *av, const void *bv)
         return b->frequency - a->frequency;
 } 
 
+
+static turbo_hz;
+
+static int is_turbo(unsigned long hz)
+{
+	if (hz == turbo_hz)
+		return 1;
+	return 0;
+}
+
+
 static char *HzToHuman(unsigned long hz)
 {	
 	static char buffer[1024];
@@ -79,6 +90,9 @@ static char *HzToHuman(unsigned long hz)
 	if (Hz>1500000)
 		sprintf(buffer, _("%6.2f Ghz"), (Hz+5000.0)/1000000);
 
+	if (is_turbo(hz))
+		sprintf(buffer, "%s", _("Turbo Mode"));
+
 
 	return buffer;
 }
@@ -164,6 +178,9 @@ void  do_cpufreq_stats(void)
 		maxfreq=4;
 	qsort(&delta, maxfreq+1, sizeof(struct cpufreqdata), sort_by_freq);
 
+	if (delta[0].frequency == delta[1].frequency + 1000)
+		turbo_hz = delta[0].frequency;
+
 	topfreq = -1;
 	for (ret = 0 ; ret<=maxfreq; ret++) {
 		sprintf(cpufreqstrings[ret+1], "%6s   %5.1f%%\n", HzToHuman(delta[ret].frequency), delta[ret].count * 100.0 / total_time);
--
cgit v0.8.3-13-ge633
